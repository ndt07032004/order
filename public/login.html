<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/css/auth.css">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
        <div class="auth-wrap">
            <div class="auth-card">
                <div class="auth-side">
                    <div class="auth-logo">
                        <svg width="42" height="42" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
                            <rect width="48" height="48" rx="10" fill="url(#g)"/>
                            <path d="M14 33 L24 18 L34 33" stroke="white" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                            <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#ff7a00"/><stop offset="1" stop-color="#ff4b4b"/></linearGradient></defs>
                        </svg>
                        <div>
                            <div class="auth-brand">THANH ƒê·∫∂NG NG√ÇN</div>
                            <div style="font-size:0.92rem;color:rgba(255,255,255,0.85)">Qu·∫£n l√Ω ƒë∆°n h√†ng</div>
                        </div>
                    </div>
                    <h1>Nhanh ‚Äî Tr·ª±c quan ‚Äî An to√†n</h1>
                    <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ qu·∫£n l√Ω menu, ƒë∆°n h√†ng v√† b√°o c√°o realtime.</p>
                </div>
                <div class="auth-form">
                    <h2>ADMIN</h2>
                    <p class="auth-sub">ƒêƒÉng nh·∫≠p ƒë·ªÉ v√†o trang qu·∫£n l√Ω</p>

                    <input type="text" id="user" class="auth-input" placeholder="T√™n ƒëƒÉng nh·∫≠p (m·∫∑c ƒë·ªãnh: admin)" onkeypress="if(event.key==='Enter') login()">
                    <input type="password" id="pass" class="auth-input" placeholder="Nh·∫≠p m·∫≠t kh·∫©u qu·∫£n tr·ªã..." onkeypress="if(event.key==='Enter') login()">

                    <div class="auth-actions"><button class="auth-btn" onclick="login()">M·ªû KH√ìA üöÄ</button></div>
                    <p id="msg" class="auth-msg"></p>
                </div>
            </div>
        </div>

    <script>
        async function login() {
            const p = document.getElementById('pass').value;
            const u = document.getElementById('user').value || 'admin';
            const btn = document.querySelector('button');
            const msg = document.getElementById('msg');
            const input = document.getElementById('pass');

            if(!p) {
                input.focus();
                return;
            }
            
            // Hi·ªáu ·ª©ng loading
            const originalText = btn.innerText;
            btn.innerText = 'ƒêANG X·ª¨ L√ù...';
            btn.style.opacity = 0.7;
            msg.style.display = 'none';

            try {
                const res = await fetch('/api/login', {
                    method: 'POST', 
                    headers: {'Content-Type':'application/json'}, 
                    body: JSON.stringify({ username: u, password: p })
                });
                const d = await res.json();
                
                if(d.success) {
                    // After initial login, require second-step password page
                    window.location.href = '/second-auth.html';
                } else { 
                    msg.style.display='block'; 
                    msg.innerText = d.message || "M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!"; 
                    btn.innerText = originalText;
                    btn.style.opacity = 1;
                    input.value = '';
                    input.focus();
                }
            } catch(e) {
                msg.style.display='block'; 
                msg.innerText = "L·ªói k·∫øt n·ªëi server!";
                btn.innerText = originalText;
                btn.style.opacity = 1;
            }
        }
    </script>
</body>
</html>